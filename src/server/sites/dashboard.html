<!DOCTYPE html>
<html>
<style>
    
    .serverList {
        list-style-type: none;
        margin: 4px;
        padding: 0;
        height:100%;
        
    }
    .component_holder{
        border: 1px solid #555;
        border-radius: 5px;
        margin: 4px;
        padding: 10px;
    }

</style>

<body>

    <div id="row" style="display:flex">
        <div class ="component_holder" id="column-left" style="width: 80%;">
            <div  style="display: flex; height: 600px;">
                <h1>Random ass graf</h1>
            </div>
        <div id="table-scroll">
            <p id="Test0"></p>
        </div>
        </div>
        
            



        <div class="component_holder" id="column-right" style="width:20%;">    
                <ul class="serverList"></ul>
        </div>
    </div>


</body>

</html>

<script>
    //TODO: change from relative paths to absolute, do this dynamically
    async function fetch_component(url, components) {
        const response = await fetch(url, {
            method: "POST",
            body: JSON.stringify(components),
            headers: {
                "Content-type": "application/json; charset=UTF-8"
            }
        })

        const data = response.json();

        return data;
    }

    async function add_components_to_DOM(components_request) {
        let components = await fetch_component("/fetch/component", components_request);
            components.forEach((component, index) => {
            components_request[index]["placement"].insertAdjacentHTML( 'beforeend', component["html"]);
            let script = document.createElement('script');
            script.textContent = component["js"];
            components_request[index]["placement"].appendChild(script);
            
        });            
    }

    document.addEventListener("DOMContentLoaded", async function() {
            let components = [
            {
                        "type": "non-shared",
                        "name": "test2.html",
                        "placement": document.body,
                        "tags": []
                    },
                    {
                        "type": "shared",
                        "name": "db_controls.html",
                        "placement": document.body,
                        "tags": []
                    }
            ]
            add_components_to_DOM(components);
  
        //add_component_to_DOM(document.getElementById("column2"), "/internal/db_controls");
        //add_component_to_DOM(document.getElementById("column-left"), "/components/test");
        //add_component_to_DOM(document.getElementById("column-right"), "/components/serverList");

    })
</script>